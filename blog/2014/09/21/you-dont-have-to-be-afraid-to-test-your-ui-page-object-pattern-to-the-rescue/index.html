
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>You Don't Have to Be Afraid to Test Your UI - Page Object Pattern to the Rescue - Panos Matsinopoulos</title>
  <meta name="author" content="Panos Matsinopoulos">

  
  <meta name="description" content="Introduction Many software engineers do not write tests for their UI because they have a good reason not to. Firstly, they believe that UI changes &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://pmatsinopoulos.github.io/blog/2014/09/21/you-dont-have-to-be-afraid-to-test-your-ui-page-object-pattern-to-the-rescue/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Panos Matsinopoulos" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-26210451-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Panos Matsinopoulos</a></h1>
  
    <h2>Senior Software Engineer: Love Creating Software, Taking Entrepreneurial Risks, Teaching Computer Programming & Blogging here or in many other places</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="panayotis@matsinopoulos.gr" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="https://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="pmatsinopoulos.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">You Don't Have to Be Afraid to Test Your UI - Page Object Pattern to the Rescue</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-09-21T18:22:00+03:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>6:22 pm</span></time>
        
           | <a href="#disqus_thread"
             data-disqus-identifier="http://pmatsinopoulos.github.io">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><h2>Introduction</h2>

<p>Many software engineers do not write tests for their UI because they have a good reason not to. Firstly, they believe that UI changes frequently, so any test would have been vulnerable to frequent changes. Secondly, they do not know about the <a href="http://martinfowler.com/bliki/PageObject.html">Page Object Pattern</a>.</p>

<!-- more -->


<p>I have been introduced to Page Object Pattern by a QA Engineer, <a href="http://gr.linkedin.com/in/stylianospapadomichelakis">Stylianos Papadomichelakis</a> while we were colleagues at <a href="https://www.linkedin.com/company/e-travel-sa">E-TRAVEL S.A.</a>. He has been using that for his QA tests, although in the Java world. I was astounded by this pattern. What a pain I got while trying to migrate a huge test suite from <code>capybara</code> 1 to <code>capybara</code> 2. If only I had page object pattern from the beginning, a 2 weeks task would have finished in 2 days.</p>

<p>Martin Fowler <a href="http://martinfowler.com/bliki/PageObject.html">explains</a>, very clearly, as always, how useful this pattern is for testing UI, and how it can insulate your tests from the frequest UI changes. When using it, change effects on the UI of your application will not have to be propagated throughout your whole test suite, but only inside your page objects.</p>

<p>And thank God, for our <code>Ruby</code> world, there is an awesome implementation of the page object pattern. The gem is called <code>site_prism</code> and you can read about it here: <a href="https://github.com/natritmeyer/site_prism">Site Prism</a>. It has very good documentation and will really help you love this gem.</p>

<p>In this article, I am going to share with you my experience using this gem. Using it for quite some time on all of my projects since I met it, I have come up with some best practices which I am sharing with you here.</p>

<p>Let&rsquo;s start</p>

<h3>Use a <code>page_objects</code> directory</h3>

<p>Put your page object Ruby files inside a directory structure that would have as parent the <code>page_objects</code> directory. So, if for example you have a Rails application, the directory structure might be:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>app
</span><span class='line'>bin
</span><span class='line'>config
</span><span class='line'>db
</span><span class='line'>features
</span><span class='line'>lib
</span><span class='line'>log
</span><span class='line'>page_objects
</span><span class='line'>public
</span><span class='line'>script
</span><span class='line'>spec
</span><span class='line'>tmp
</span><span class='line'>vendor</span></code></pre></td></tr></table></div></figure>


<p>As you can see the <code>page_objects</code> is on the same directory level like the <code>features</code> which contains the <code>Cucumber</code> features and the <code>spec</code> which contains the <code>RSpec</code> test files. <code>Cucumber</code> and <code>RSpec</code> will both be using your <code>page_objects</code>.</p>

<h3>Use <code>&lt;your-app-name&gt;/page_objects</code> namespace</h3>

<p>Although you are free to put all of your page object files inside the <code>page_objects</code> directory, prefer to use a sub-directory with the name of your application that would function as namespace. Further namespace that, with the word <code>page_objects</code>. For example, if your application is called <code>bookstore</code>, then you can use the following tree to store your page objects:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>page_objects
</span><span class='line'>  |-&gt; bookstore
</span><span class='line'>        |-&gt; page_objects</span></code></pre></td></tr></table></div></figure>


<p>Any <code>.rb</code> file that you will be creating to hold a page object class, will need to be inside the corresponding module <code>Bookstore::PageObjects</code> that will work as a namespace.
Using namespace is a good practice in general and not only for the <code>site_prism</code> case we are discussing here. You will avoid having name conflicts with third-party gems.</p>

<h3>Use a file to require them all</h3>

<p>Write an <code>all_page_objects.rb</code> file that will require all the page objects Ruby files that would be living in your <code>page_objects</code> tree.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>page_objects
</span><span class='line'>  |-&gt; bookstore
</span><span class='line'>  |     |-&gt; page_objects
</span><span class='line'>  |- all_page_objects.rb</span></code></pre></td></tr></table></div></figure>


<p>An implementation of <code>all_page_objects.rb</code> file might be something like the following:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># file: page_objects/all_page_objects.rb</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="n">current_path</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'><span class="vg">$LOAD_PATH</span><span class="o">.</span><span class="n">unshift</span> <span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_path</span><span class="p">,</span> <span class="s1">&#39;bookstore&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="no">Dir</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_path</span><span class="p">,</span> <span class="s1">&#39;**&#39;</span><span class="p">,</span> <span class="s1">&#39;*.rb&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">require</span> <span class="n">f</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Having done that, you only have to require the <code>all_page_objects</code> file from your <code>spec_helper.rb</code> or <code>env.rb</code> file. And everytime a new page object file is defined, you do not have to require that explicitly.</p>

<h3>Different directory for pages and sections</h3>

<p>Site prism offers two classes to organize your page object code. Pages and Sections. Use a separate directory to hold your page classes and a separate directory to hold your sections classes.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">page_objects</span>
</span><span class='line'>  <span class="o">|-&gt;</span> <span class="n">bookstore</span>
</span><span class='line'>  <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">page_objects</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-&gt;</span> <span class="n">pages</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-&gt;</span> <span class="n">sections</span>
</span><span class='line'>  <span class="o">|-</span> <span class="n">all_page_objects</span><span class="o">.</span><span class="n">rb</span>
</span></code></pre></td></tr></table></div></figure>


<p>You will use each one of these two directories to further namespace your classes. Hence all your page object classes that are pages will be <code>Bookstore::PageObjects::Pages::</code> namespaced, and all your page object classes that are sections will be <code>Bookstore::PageObjects::Sections::</code> namespaced.</p>

<h3>Follow your views directory structure</h3>

<p>Although you can put all your page classes inside the <code>page_objects/bookstore/page_objects/pages</code> directory, you should be further separating your pages directory into subdirectories that follow your views directory structure.</p>

<p>If for example you have a views directory that has two directories, <code>books</code> and <code>authors</code>, former one having the views that are related to <code>Book</code> resource and latter one having the views that are related to <code>Author</code> resource, you should have corresponding directories inside the <code>page_objects/pages</code> directory:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">page_objects</span>
</span><span class='line'>  <span class="o">|-&gt;</span> <span class="n">bookstore</span>
</span><span class='line'>  <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">page_objects</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-&gt;</span> <span class="n">pages</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">books</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">authors</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-&gt;</span> <span class="n">sections</span>
</span><span class='line'>  <span class="o">|-</span> <span class="n">all_page_objects</span><span class="o">.</span><span class="n">rb</span>
</span></code></pre></td></tr></table></div></figure>


<p>Think about whether you can do the same for the <code>sections</code> too. If you have <code>sections</code> that are resource specific, you can follow a similar directory structure.</p>

<p>In any case, the page classes that you will define will need to be further namespaced.</p>

<h3>Follow your views templates</h3>

<p>When defining your actual page classes follow the views templates and create one page per template view. For example, if you have a view template that indexes all the books in your bookstore, e.g. <code>index.html.erb</code> inside the <code>books</code> view directory, then create the corresponding page inside the file <code>index_page.rb</code>. Similarly for <code>new</code>, <code>show</code>, <code>edit</code> views:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">page_objects</span>
</span><span class='line'>  <span class="o">|-&gt;</span> <span class="n">bookstore</span>
</span><span class='line'>  <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">page_objects</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-&gt;</span> <span class="n">pages</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">books</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">index_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">new_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">show_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">edit_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">authors</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">index_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">new_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">show_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">edit_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-&gt;</span> <span class="n">sections</span>
</span><span class='line'>  <span class="o">|-</span> <span class="n">all_page_objects</span><span class="o">.</span><span class="n">rb</span>
</span></code></pre></td></tr></table></div></figure>


<p>Hence, your page classes will be defined as follows (example for the <code>index_page.rb</code> for <code>books</code>):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># file: page_objects/bookstore/page_objects/pages/books/index_page.rb</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="k">module</span> <span class="nn">Bookstore</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">PageObjects</span>
</span><span class='line'>    <span class="k">module</span> <span class="nn">Pages</span>
</span><span class='line'>      <span class="k">module</span> <span class="nn">Books</span>
</span><span class='line'>        <span class="k">class</span> <span class="nc">IndexPage</span> <span class="o">&lt;</span> <span class="ss">SitePrism</span><span class="p">:</span><span class="ss">:Page</span>
</span><span class='line'>          <span class="c1"># ... your page code goes here ... #</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h3>One file to model your application</h3>

<p>Create a file <code>application.rb</code> that will be used to instantiate the concrete page classes and will be used to access all the pages while working with site prism API on <code>feautures</code> <code>steps</code> or <code>spec</code> tests.</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">page_objects</span>
</span><span class='line'>  <span class="o">|-&gt;</span> <span class="n">bookstore</span>
</span><span class='line'>  <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">page_objects</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-&gt;</span> <span class="n">pages</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">books</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">index_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">new_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">show_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">edit_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|-&gt;</span> <span class="n">authors</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">index_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">new_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">show_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|</span>     <span class="o">|----</span> <span class="n">edit_page</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-&gt;</span> <span class="n">sections</span>
</span><span class='line'>  <span class="o">|</span>           <span class="o">|-</span> <span class="n">application</span><span class="o">.</span><span class="n">rb</span>
</span><span class='line'>  <span class="o">|-</span> <span class="n">all_page_objects</span><span class="o">.</span><span class="n">rb</span>
</span></code></pre></td></tr></table></div></figure>


<p>So, you are going to have <code>page_objects/bookstore/page_objects/application.rb</code>
Here is a sample implementation in order to understand what I am talking about:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># file: page_objects/bookstore/page_objects/application.rb</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="k">module</span> <span class="nn">Bookstore</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">PageObjects</span>
</span><span class='line'>    <span class="k">class</span> <span class="nc">Application</span>
</span><span class='line'>      <span class="k">def</span> <span class="nf">initialize</span>
</span><span class='line'>        <span class="vi">@pages</span> <span class="o">=</span> <span class="p">{}</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">def</span> <span class="nf">home</span>
</span><span class='line'>        <span class="vi">@pages</span><span class="o">[</span><span class="ss">:home</span><span class="o">]</span> <span class="o">||=</span> <span class="ss">Bookstore</span><span class="p">:</span><span class="ss">:PageObjects</span><span class="o">::</span><span class="ss">Pages</span><span class="p">:</span><span class="ss">:HomePage</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">def</span> <span class="nf">sign_in</span>
</span><span class='line'>        <span class="vi">@pages</span><span class="o">[</span><span class="ss">:sign_in</span><span class="o">]</span> <span class="o">||=</span> <span class="ss">Bookstore</span><span class="p">:</span><span class="ss">:PageObjects</span><span class="o">::</span><span class="ss">Pages</span><span class="p">:</span><span class="ss">:SignInPage</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>      <span class="k">def</span> <span class="nf">checkout</span>
</span><span class='line'>        <span class="vi">@pages</span><span class="o">[</span><span class="ss">:checkout</span><span class="o">]</span> <span class="o">||=</span> <span class="ss">Bookstore</span><span class="p">:</span><span class="ss">:PageObjects</span><span class="o">::</span><span class="ss">Pages</span><span class="p">:</span><span class="ss">:CheckoutPage</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>When you will be using site prism, you will only be instantiating the <code>Bookstore::PageObjects::Application</code> class once and then you will be invoking page methods to access specific pages. For example:</p>

<p>If using <code>Cucumber</code>, inside the <code>features/support/hooks.rb</code> file you can have</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Before</span> <span class="k">do</span> <span class="o">|</span><span class="n">scenario</span><span class="o">|</span>
</span><span class='line'>  <span class="vi">@app</span> <span class="o">||=</span> <span class="ss">Bookstore</span><span class="p">:</span><span class="ss">:PageObjects</span><span class="o">::</span><span class="no">Application</span><span class="o">.</span><span class="n">new</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>which will instantiate the <code>Bookstore::PageObjects::Application</code> and store it in <code>@app</code> that you can use to load and access pages as follows (in your <code>steps</code>):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">When</span><span class="p">(</span><span class="sr">/^User visits the home pages$/</span><span class="p">)</span><span class="k">do</span>
</span><span class='line'>  <span class="vi">@app</span><span class="o">.</span><span class="n">home</span><span class="o">.</span><span class="n">load</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">When</span><span class="p">(</span><span class="sr">/^User visits the sign in page$/</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>  <span class="vi">@app</span><span class="o">.</span><span class="n">sign_in</span><span class="o">.</span><span class="n">load</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>You can see that the <code>Bookstore::PageObjects::Application</code> is being instantiated only once and each page is being instantiated only once too. The application instance is using, internally, a hash to store the instances of the necessary pages. So, everytime you need a page, either an existing instance of the page will be returned, if you have requested same page in the past, case in which it will be located in the <code>@pages</code> hash, or a new instance will be created.</p>

<h3><code>elements</code> vs <code>sections</code></h3>

<p>Sometimes, especially when you are new to site prism, you cannot decide very easily when you should be using <code>elements</code> vs <code>sections</code>.</p>

<p>If you understand the difference between an <code>element</code> and a <code>section</code> then it should be easy.</p>

<p><code>element</code> is primitive dom selection that cannot contain other elements.</p>

<p><code>section</code> should be used whenever you have a dom area that you want to select and that you want to treat its constituent elements separately, with further site prism API manipulation. In other words, <code>section</code> should be containing one or more <code>element</code> (and/or other <code>element</code>s, <code>elements</code>, <code>section</code>s or <code>sections</code>).</p>

<p>Finally, both <code>elements</code> and <code>sections</code> select structures of the dom that appear as arrays in the dom. <code>elements</code> select an array of <code>element</code>. <code>sections</code> select an array of <code>section</code>.</p>

<p>Hence, if you have an index page that displays the list of books, you can have the following inside the index page definition:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># file: page_objects/bookstore/page_objects/pages/books/index_page.rb</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="k">module</span> <span class="nn">Bookstore</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">PageObjects</span>
</span><span class='line'>    <span class="k">module</span> <span class="nn">Pages</span>
</span><span class='line'>      <span class="k">module</span> <span class="nn">Books</span>
</span><span class='line'>        <span class="k">class</span> <span class="nc">IndexPage</span> <span class="o">&lt;</span> <span class="ss">SitePrism</span><span class="p">:</span><span class="ss">:Page</span>
</span><span class='line'>
</span><span class='line'>          <span class="n">elements</span> <span class="ss">:book_items</span><span class="p">,</span> <span class="s1">&#39;#books-table tr.book-item&#39;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>which will give you access to each one of the table rows that are used to display a book entry. But this definition does not allow to do too much with the book item itself.</p>

<p>If for example, you want to access details of the book, you can use a section and say that you have an array of sections, as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># file: page_objects/bookstore/page_objects/pages/books/index_page.rb</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="nb">require</span> <span class="s2">&quot;bookstore/page_objects/sections/books/book_entry_section&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">Bookstore</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">PageObjects</span>
</span><span class='line'>    <span class="k">module</span> <span class="nn">Pages</span>
</span><span class='line'>      <span class="k">module</span> <span class="nn">Books</span>
</span><span class='line'>        <span class="k">class</span> <span class="nc">IndexPage</span> <span class="o">&lt;</span> <span class="ss">SitePrism</span><span class="p">:</span><span class="ss">:Page</span>
</span><span class='line'>
</span><span class='line'>          <span class="n">sections</span> <span class="ss">:book_items</span><span class="p">,</span> <span class="ss">Bookstore</span><span class="p">:</span><span class="ss">:PageObjects</span><span class="o">::</span><span class="ss">Sections</span><span class="p">:</span><span class="ss">:Books</span><span class="o">::</span><span class="no">BookEntrySection</span><span class="p">,</span> <span class="s1">&#39;#books-table tr.book-item&#39;</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>And then you need to define the book entry details in the corresponding section file:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># file: page_objects/bookstore/page_objects/sections/books/book_entry_section.rb</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="k">module</span> <span class="nn">Bookstore</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">PageObjects</span>
</span><span class='line'>    <span class="k">module</span> <span class="nn">Sections</span>
</span><span class='line'>      <span class="k">module</span> <span class="nn">Books</span>
</span><span class='line'>        <span class="k">class</span> <span class="nc">BookEntrySection</span> <span class="o">&lt;</span> <span class="ss">SitePrism</span><span class="p">:</span><span class="ss">:Section</span>
</span><span class='line'>          <span class="n">element</span> <span class="ss">:title</span><span class="p">,</span>        <span class="s1">&#39;td.title&#39;</span>
</span><span class='line'>          <span class="n">element</span> <span class="ss">:author</span><span class="p">,</span>       <span class="s1">&#39;td.author&#39;</span>
</span><span class='line'>          <span class="n">element</span> <span class="ss">:published_at</span><span class="p">,</span> <span class="s1">&#39;td.published-at&#39;</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>But, again&hellip;.</p>

<h3>Prefer inline <code>section</code> (and <code>sections</code>) blocks</h3>

<p>You should not be using separate class definitions for sections of pages that are not reusable among pages. It&rsquo;s waste of effort, time and requires more maintenance. Create a separate class, on a seperate file, for a section, only if this section can be reused among page definitions. Otherwise, define the section elements inline with a block.</p>

<p>Hence, the above implementation for the book item, is not something that I recommend. I wouldn&rsquo;t create a section for that. You should just define the section elements inline as follows:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># file: page_objects/bookstore/page_objects/pages/books/index_page.rb</span>
</span><span class='line'><span class="c1">#</span>
</span><span class='line'><span class="k">module</span> <span class="nn">Bookstore</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">PageObjects</span>
</span><span class='line'>    <span class="k">module</span> <span class="nn">Pages</span>
</span><span class='line'>      <span class="k">module</span> <span class="nn">Books</span>
</span><span class='line'>        <span class="k">class</span> <span class="nc">IndexPage</span> <span class="o">&lt;</span> <span class="ss">SitePrism</span><span class="p">:</span><span class="ss">:Page</span>
</span><span class='line'>          <span class="c1"># .... other index page code .... #</span>
</span><span class='line'>
</span><span class='line'>          <span class="n">sections</span> <span class="ss">:book_items</span><span class="p">,</span> <span class="s1">&#39;#books-table tr.book-item&#39;</span> <span class="k">do</span>
</span><span class='line'>            <span class="n">element</span> <span class="ss">:title</span><span class="p">,</span>        <span class="s1">&#39;td.title&#39;</span>
</span><span class='line'>            <span class="n">element</span> <span class="ss">:author</span><span class="p">,</span>       <span class="s1">&#39;td.author&#39;</span>
</span><span class='line'>            <span class="n">element</span> <span class="ss">:published_at</span><span class="p">,</span> <span class="s1">&#39;td.published-at&#39;</span>
</span><span class='line'>          <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>          <span class="c1"># ... other index page code ... #</span>
</span><span class='line'>        <span class="k">end</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<p>Doing so, I do not have to create another class file specific to this section.</p>

<p>Note that this hint is valid both for <code>section</code> and <code>sections</code>, of course.</p>

<h3>Use ids - Do not use style properties for selectors</h3>

<p>This suggestion goes out of the scope of site prism. When you are using selectors to select dom elements on your tests use html element ids, e.g. &lsquo;#books-table&rsquo; as much as you can. Do not use other attributes that style your elements or depend on the layout and structure of your dom. They are brittle to change. And if you write your tests and you see that your pages are missing ids that would help you write your tests, then go back to your core code and add ids.</p>

<h2>Final</h2>

<p>I believe that the page object pattern is a fantastic practice to isolate your tests from accessing UI test API (like <code>Capybara</code>) directly. And <a href="https://github.com/natritmeyer/site_prism">site_prism</a> is a perfect implementation.</p>

<p>I hope that the above notes can help you organize your page objects code and become a practice in your development/QA team. Or at least start a discussion inside it about how you can better organize your page objects code.</p>

<p>I would appreciate any comment and feedback to make the above even better.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Panos Matsinopoulos</span></span>

      




<time class='entry-date' datetime='2014-09-21T18:22:00+03:00'><span class='date'><span class='date-month'>Sep</span> <span class='date-day'>21</span><span class='date-suffix'>st</span>, <span class='date-year'>2014</span></span> <span class='time'>6:22 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/patterns/'>patterns</a>, <a class='category' href='/blog/categories/ruby/'>ruby</a>, <a class='category' href='/blog/categories/ruby-on-rails/'>ruby on rails</a>, <a class='category' href='/blog/categories/test/'>test</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://pmatsinopoulos.github.io/blog/2014/09/21/you-dont-have-to-be-afraid-to-test-your-ui-page-object-pattern-to-the-rescue/" data-via="pmatsino" data-counturl="http://pmatsinopoulos.github.io/blog/2014/09/21/you-dont-have-to-be-afraid-to-test-your-ui-page-object-pattern-to-the-rescue/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/08/29/united-states-counties-cities-csv-ruby-loading-code/" title="Previous Post: United States, Counties, Cities, Zips CSV & Ruby loading code">&laquo; United States, Counties, Cities, Zips CSV & Ruby loading code</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/12/12/delayed-job-best-practices/" title="Next Post: Delayed Job Best Practices">Delayed Job Best Practices &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2021/03/16/input-notes-to-musescore-with-vmpk/">Input Notes to MuseScore With VMPK</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/03/07/event-driven-architecture-demo/">Event-Driven Architecture Demo</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/02/19/ruby-and-trusting-young-people/">Ruby and Trusting Young People</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/02/18/custom-exception-hierarchy-best-practices/">Custom Exception Hierarchy Best Practices</a>
      </li>
    
      <li class="post">
        <a href="/blog/2020/11/21/hanami-vs-ruby-on-rails/">Hanami vs Ruby on Rails</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/pmatsinopoulos">@pmatsinopoulos</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'pmatsinopoulos',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/panayotis@matsinopoulos.gr?rel=author">
      <img src="https://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2021 - Panos Matsinopoulos -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'pmatsinopoulos';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://pmatsinopoulos.github.io/blog/2014/09/21/you-dont-have-to-be-afraid-to-test-your-ui-page-object-pattern-to-the-rescue/';
        var disqus_url = 'http://pmatsinopoulos.github.io/blog/2014/09/21/you-dont-have-to-be-afraid-to-test-your-ui-page-object-pattern-to-the-rescue/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
